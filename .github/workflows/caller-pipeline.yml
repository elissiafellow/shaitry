name: Shai-Hulud 2 Supply Chain Test

on:
  push:
    branches: [ "main" ]
  pull_request:
    types: [opened, synchronize]

jobs:
  scan-root:
    uses: elissiafellow/shaitry/.github/workflows/shai-hulud-2-scanner.yml@main
    with:
      node_version: "18"
      fail_on: "low"
      strip_private_deps: false
      scan_target: "."  # root package.json

  scan-frontend:
    needs: scan-root
    uses: elissiafellow/shaitry/.github/workflows/shai-hulud-2-scanner.yml@main
    with:
      node_version: "18"
      fail_on: "low"
      strip_private_deps: false
      scan_target: "frontend"  # frontend package.json
